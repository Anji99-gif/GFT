<mat-toolbar color="warning">
  <span>Details</span>
  <span class="spacer"></span>
  <div class="actionButtons">
    <button  mat-stroked-button color="primary" (click)="cancel()" >{{ action ==='view'? "Done":  "Cancel"}}</button>
  </div>
</mat-toolbar>
<form [formGroup]="partyForm" enctype="multipart/form-data">
  <mat-form-field appearance="outline">
    <mat-label>Name</mat-label>
    <input matInput formControlName="name">
    <mat-error *ngIf="partyForm.get('name')?.hasError('required')">Name is required</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Company Name</mat-label>
    <input matInput formControlName="company_name">
    <mat-error *ngIf="partyForm.get('company_name')?.hasError('required')">Company Name is required</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Mobile No</mat-label>
    <input matInput formControlName="mobile_no">
    <mat-error *ngIf="partyForm.get('mobile_no')?.hasError('required')">Mobile No is required</mat-error>
    <mat-error *ngIf="partyForm.get('mobile_no')?.hasError('pattern')">Invalid Mobile No</mat-error>
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Telephone No</mat-label>
    <input matInput formControlName="telephone_no">
    <mat-error *ngIf="partyForm.get('telephone_no')?.hasError('required')">Mobile No is required</mat-error>
    <mat-error *ngIf="partyForm.get('telephone_no')?.hasError('pattern')">Invalid Mobile No</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Whatsapp No</mat-label>
    <input matInput formControlName="whatsapp_no">
    <mat-error *ngIf="partyForm.get('whatsapp_no')?.hasError('required')">Mobile No is required</mat-error>
    <mat-error *ngIf="partyForm.get('whatsapp_no')?.hasError('pattern')">Invalid Mobile No</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Email</mat-label>
    <input matInput formControlName="email">
    <mat-error *ngIf="partyForm.get('email')?.hasError('required')">Mobile No is required</mat-error>
    <mat-error *ngIf="partyForm.get('email')?.hasError('pattern')">Invalid Mobile No</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Remark</mat-label>
    <input matInput formControlName="remark">
    <mat-error *ngIf="partyForm.get('remark')?.hasError('required')">Mobile No is required</mat-error>
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>DOB</mat-label>
    <input type="date" matInput formControlName="date_of_birth">
    <mat-error *ngIf="partyForm.get('date_of_birth')?.hasError('required')">Date of Birth Is Required</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Anniversary Date</mat-label>
    <input matInput type="date" formControlName="anniversary_date">
    <mat-error *ngIf="partyForm.get('anniversary_date')?.hasError('required')">Anniversary Date Is Required</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>GSTIN</mat-label>
    <input matInput formControlName="gstin">
    <mat-error *ngIf="partyForm.get('gstin')?.hasError('required')">GSTIN Is Required</mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>PAN No</mat-label>
    <input matInput formControlName="pan_no">
    <mat-error *ngIf="partyForm.get('pan_no')?.hasError('required')">PAN Is Required</mat-error>
  </mat-form-field>

   <mat-checkbox formControlName="apply_tds">Apply TDS</mat-checkbox>

  <mat-form-field appearance="outline">
    <mat-label>Credit Limit</mat-label>
    <input type="number" min="0" matInput formControlName="credit_limit">
    <mat-error *ngIf="partyForm.get('credit_limit')?.hasError('required')">Credit Limit Is Required</mat-error>
  </mat-form-field>

  <div formGroupName="userid">
    <mat-form-field appearance="outline">
      <mat-label>Username</mat-label>
      <input matInput formControlName="username">
      <mat-error *ngIf="partyForm.get('username')?.hasError('required')">Required</mat-error>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Phone No</mat-label>
      <input matInput formControlName="phone_number">
      <mat-error *ngIf="partyForm.get('phone_number')?.hasError('required')">Required</mat-error>
    </mat-form-field>
   <mat-checkbox formControlName="is_active">Active</mat-checkbox>

  </div>

<h2>Bank Details</h2>
  <div formArrayName="bank_id">
    <div *ngFor="let bank of bank_id.controls; let i = index" [formGroupName]="i">
      <mat-form-field appearance="outline">
        <mat-label>Bank IFSC Code</mat-label>
        <input matInput formControlName="bank_ifsc_code">
        <mat-error *ngIf="bank.get('bank_ifsc_code')?.hasError('required')">Bank IFSC Code is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Bank Name</mat-label>
        <input matInput formControlName="bank_name">
        <mat-error *ngIf="bank.get('bank_name')?.hasError('required')">Bank Name is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Branch Name</mat-label>
        <input matInput formControlName="branch_name">
        <mat-error *ngIf="bank.get('branch_name')?.hasError('required')">Branch Name is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Account No</mat-label>
        <input matInput formControlName="account_no">
        <mat-error *ngIf="bank.get('account_no')?.hasError('required')">Account No is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Account Holder Name</mat-label>
        <input matInput formControlName="account_holder_name">
        <mat-error *ngIf="bank.get('account_holder_name')?.hasError('required')">Account Holder Name</mat-error>
      </mat-form-field>
    <mat-checkbox formControlName="is_active">Active</mat-checkbox>
    <button mat-icon-button color="accent" (click)="deleteBank(i)"> <mat-icon>delete</mat-icon></button>
  </div>
  <button mat-raised-button color="accent" (click)="addBank()">Add Bank</button>
  </div>
  <h2>Address</h2>

  <div formArrayName="address">
    <div *ngFor="let addr of address.controls; let i = index" [formGroupName]="i">
      <mat-form-field appearance="outline">
        <mat-label>Address Line 1</mat-label>
        <input matInput formControlName="address_line_1">
        <mat-error *ngIf="addr.get('address_line_1')?.hasError('required')">Address Line 1 is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Address Line 2</mat-label>
        <input matInput formControlName="address_line_2">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Country</mat-label>
        <input matInput formControlName="country">
        <mat-error *ngIf="addr.get('country')?.hasError('required')">Country is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>State</mat-label>
        <input matInput formControlName="state">
        <mat-error *ngIf="addr.get('state')?.hasError('required')">Country is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>City</mat-label>
        <input matInput formControlName="city">
        <mat-error *ngIf="addr.get('city')?.hasError('required')">required</mat-error>
      </mat-form-field>
      <mat-checkbox formControlName="is_active">Active</mat-checkbox>
      <mat-form-field appearance="outline">
        <mat-label>Pincode</mat-label>
        <input matInput formControlName="pincode">
        <mat-error *ngIf="addr.get('pincode')?.hasError('required')">required</mat-error>
      </mat-form-field>

      <button mat-icon-button color="accent" (click)="deleteAddress(i)"> <mat-icon>delete</mat-icon></button>
    </div>
    <button mat-raised-button color="accent" (click)="addAddress()">Add Address</button>
  </div>
<hr>
  <br>
  <div class="fileUpload">
    <div>
      <label for="file">Image</label>
      <input  id="file" type="file" (change)="onFileChange($event)" />
    </div>
    <img *ngIf="partyForm.get('image')?.value" [src]="baseUrl+partyForm.get('image')?.value" alt="Current Image" style="width: 100px; height: auto;">
  </div>

  <div class="actionButtons">
    <button  mat-stroked-button color="primary" (click)="cancel()">{{ action ==='view'? "Done":  "Cancel"}}</button>
    <button mat-raised-button color="primary" (click)="onSubmit()" type="submit" *ngIf="action!=='view'">Submit</button>
  </div>
</form>
